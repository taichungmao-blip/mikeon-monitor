name: Mikeon88 Daily Monitor

on:
  schedule:
    # GitHub ä½¿ç”¨ UTC æ™‚é–“ã€‚æ—¥æœ¬ 11:00 = UTC 02:00
    - cron: '0 2 * * *'
  # å…è¨±æ‰‹å‹•é»æ“ŠæŒ‰éˆ•è§¸ç™¼ (æ–¹ä¾¿æ¸¬è©¦ç”¨)
  workflow_dispatch:

permissions:
  contents: write

jobs:
  check_and_notify:
    # é€™è£¡ä¿®æ­£äº†ï¼šä½¿ç”¨ runs-on (é€£å­—è™Ÿ)
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'
 # ğŸ‘‡ åŠ å…¥é€™ä¸€æ®µï¼šå®‰è£ Selenium
    - name: Install dependencies
      run: |
       python -m pip install --upgrade pip
       pip install selenium
    - name: Install dependencies
      run: |
        pip install requests beautifulsoup4

    - name: Run Monitor Script
      env:
        # é€™è£¡æœƒè®€å–ä½ åœ¨ GitHub è¨­å®šçš„ Secret
        DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
      run: python main.py

    - name: Commit and Push changes
      # å¦‚æœ status.json æœ‰æ›´æ–° (ç¿»é æˆ–æœ‰æ–°æ–‡)ï¼Œå°±å­˜å› GitHub
      run: |
        git config --global user.name "GitHub Actions Bot"
        git config --global user.email "actions@github.com"
        git add status.json
        # å¦‚æœæ²’æœ‰è®ŠåŒ–ï¼Œcommit æœƒå¤±æ•—ï¼Œæ‰€ä»¥åŠ ä¸Š || exit 0 è®“å®ƒä¸è¦å ±éŒ¯
        git commit -m "Update monitor status" || exit 0
        git push
